import{E as e,r as t,M as l,g as r,a5 as a,T as i,L as o,d as c,f as s,o as n,c as u,w as d,a as p,m as f,q as y,H as k,b,I as m,i as g,a6 as x,n as h}from"./index.6e0bac9a.js";import{_}from"./kui-text.66024d1c.js";import{r as C,_ as S}from"./kui-page.9f67228f.js";import{_ as I}from"./kui-icons.87a80e4b.js";import{_ as z}from"./plugin-vue_export-helper.21dcd24c.js";import{_ as v}from"./kui-cell-group.96f4bfae.js";import{_ as T}from"./kui-button.09ff88a3.js";import{_ as P}from"./kui-space.b29851da.js";import"./kui-spin.741eeb84.js";var W=z(e({name:"kui-progress",props:{type:{type:String,default:"linear"},percent:{type:Number,default:0},label:{type:Boolean,default:!0},labelInside:{type:Boolean,default:!1},insideLabelStyle:{type:Object,default:{}},shape:{type:String,default:"round"},color:{type:String,default:"#00BC79"},trackColor:{type:String,default:""},lineWidth:{type:Number,default:20},track:{type:Boolean,default:!0},size:{type:Number,default:200},rotate:{type:String,default:""},labelTextSize:{type:Number,default:14},labelTextColor:{type:String,default:""},active:{type:Boolean,default:!1},iconName:{type:String,default:""},labelInsideTextBottom:{type:String,default:""},id:{type:String,default:""}},setup(e,s){const{proxy:n}=c(),u=n.$theme,d=t({labelTextSize:e.labelTextSize,labelTextColor:"",lineWidth:e.lineWidth,backgroundColor:e.color,backgroundImage:"",labelInsideTextBottom:"",percent:e.percent<0?0:e.percent,ctx_e:null,z:0,canvasId:"",canvasId2:"",sAngle:null,loadOK:!1,timer:null,animation:{step:1,transEnd:300}});d.percent=e.percent>100?100:d.percent;const p=l((()=>{const l=t({});return d.lineWidth=e.lineWidth,l.height=`${d.lineWidth}rpx`,l.borderRadius=`${d.lineWidth}px`,"square"===e.shape&&(l.borderRadius="5rpx"),d.labelTextColor=e.labelTextColor?e.labelTextColor:u.colors.light.grey[7],d.labelTextColor=u.colors.light[e.labelTextColor]?u.colors.light[e.labelTextColor][5]:d.labelTextColor,l})),f=l((()=>{const l=t({});return l.backgroundColor=e.trackColor?e.trackColor:u.colors.dark.grey[8],l})),y=l((()=>{const l=t({});return l.width=`${d.percent}%`,d.backgroundImage=u.colors.light[e.color]?`linear-gradient(to right, ${u.colors.light[e.color][5]}, ${u.colors.light[e.color][4]})`:d.backgroundColor,l.backgroundColor=d.backgroundColor,l.backgroundImage=d.backgroundImage,l.transition="all 0.4s ease",l})),k=l((()=>{const e=t({});return e.fontSize=`${u.size.fonts.sm}${u.size.fontUnit}`,e})),b=l((()=>{const l=t({}),r=1.5*e.lineWidth;return l.height=`${r}rpx`,l.width="70rpx",e.lineWidth<20&&(l.height="30rpx"),l.borderRadius="10rpx",l.backgroundColor=d.backgroundColor,l.backgroundImage=d.backgroundImage,l})),m=l((()=>{const l=t({}),r=e.labelInsideTextBottom?e.labelInsideTextBottom:"";return l.bottom=r,l}));r().pixelRatio;const g=l((()=>{const l=t({});return l.width=l.height=`${e.size}px`,l.zoom=.5,l})),x=(t,l=!0)=>{const r=e.trackColor?e.trackColor:u.colors.dark.grey[8],a=Math.PI/20*(d.percent/100*20)*2;console.log(a),Math.PI,d.percent;let i=0,o=d.animation.transEnd||200;d.timer=setInterval((()=>{if(d.loadOK=!0,i>o)clearInterval(d.timer);else{t.clearRect(0,0,e.size,e.size);let l=a/o*i;h(t,{x:e.size/2,y:e.size/2,radius:e.size/2-e.lineWidth,sAngle:-Math.PI,eAngle:Math.PI,counterclockwise:!1,fillColor:r,lineWidth:e.lineWidth}),h(t,{x:e.size/2,y:e.size/2,radius:e.size/2-e.lineWidth,sAngle:-Math.PI,eAngle:-Math.PI+l,counterclockwise:!1,fillColor:d.backgroundColor,lineWidth:e.lineWidth}),i+=d.animation.step||1,t.draw()}}),0)},h=(e,t)=>{const{x:l,y:r,radius:a,sAngle:i,eAngle:o,counterclockwise:c,lineWidth:s,fillColor:n}=t;let u=e.createLinearGradient(0,0,0,0);e.beginPath(),e.lineWidth=s,e.strokeStyle=n,e.lineCap="round",e.setFillStyle(u),e.arc(l,r,a,i,o,c),e.stroke()},_=()=>{setTimeout((()=>{x(d.ctx_e)}),200)};if("circle"===e.type){const t="progress-circle";d.canvasId=e.id?`${t}-${e.id}`:t,a(d.canvasId2,n),i().in(n).select(`#${d.canvasId}`),e.trackColor?e.trackColor:u.colors.dark.grey[8],d.ctx_e=a(d.canvasId,n),_()}return o((()=>e.percent),(t=>t<0?(d.percent=0,!1):t>100?(d.percent=100,!1):void setTimeout((()=>{d.percent=t,"circle"===e.type&&x(d.ctx_e),console.log(d.percent)}),200))),{commonStyle:p,rootStyle:f,contentStyle:y,labelStyle:k,labelInsideStyle:b,labelInsideTextStyle:m,circleStyle:g,fillRing:h,initDraw:_,state:d}}}),[["render",function(e,t,l,r,a,i){const o=g,c=C(s("kui-text"),_),h=C(s("kui-icons"),I),S=x;return n(),u(o,null,{default:d((()=>["linear"===e.type?(n(),u(o,{key:0,class:"kui-flex kui-items-center"},{default:d((()=>[p(o,{class:"kui-progress kui-relative kui-w-full",style:f([e.commonStyle,e.rootStyle])},{default:d((()=>[p(o,{class:"kui-flex"},{default:d((()=>[p(o,{class:"kui-absolute kui-h-full progress",style:f([e.commonStyle,e.contentStyle])},{default:d((()=>[e.active?(n(),u(o,{key:0,class:"kui-progress-active"})):y("",!0)])),_:1},8,["style"]),e.labelInside?(n(),u(o,{key:0,class:"kui-flex kui-flex-col kui-justify-center kui-absolute",style:f([{top:"-25%"},[{left:e.state.percent-5+"%",top:(e.lineWidth<20?-100:-25)+"%"},e.insideLabelStyle]])},{default:d((()=>[k(e.$slots,"default",{},(()=>[p(o,{style:f(e.labelInsideStyle)},{default:d((()=>[p(o,{class:"kui-relative kui-flex kui-justify-center kui-items-center kui-h-full",style:f(e.labelInsideTextStyle)},{default:d((()=>[p(c,{size:"12px",color:"white"},{default:d((()=>[b(m(e.state.percent)+"% ",1)])),_:1})])),_:1},8,["style"])])),_:1},8,["style"])]),!0)])),_:3},8,["style"])):y("",!0)])),_:3})])),_:3},8,["style"]),!e.label||e.labelInside||e.iconName?y("",!0):(n(),u(o,{key:0,class:"kui-ml-1",style:f(e.labelStyle)},{default:d((()=>[p(c,{size:`${e.state.labelTextSize}px`,color:e.state.labelTextColor},{default:d((()=>[b(m(e.state.percent)+"% ",1)])),_:1},8,["size","color"])])),_:1},8,["style"])),e.iconName?(n(),u(o,{key:1,class:"kui-ml-1",style:f(e.labelStyle)},{default:d((()=>[p(h,{type:e.iconName,size:e.state.labelTextSize,color:e.state.labelTextColor},null,8,["type","size","color"])])),_:1},8,["style"])):y("",!0)])),_:3})):y("",!0),"circle"===e.type?(n(),u(o,{key:1,class:"kui-relative"},{default:d((()=>[p(S,{class:"kui-progress-circle kui-absolute1",id:e.state.canvasId,"canvas-id":e.state.canvasId,style:f(e.circleStyle)},null,8,["id","canvas-id","style"]),p(o,{class:"kui-absolute kui-w-full kui-h-full kui-flex kui-justify-center kui-items-center kui-transform",style:f([{transform:"scale(2)",left:"0",top:"0"},e.circleStyle])},{default:d((()=>[k(e.$slots,"default",{},void 0,!0)])),_:3},8,["style"])])),_:3})):y("",!0)])),_:3})}],["__scopeId","data-v-0c9c16d5"]]);var w=z({setup(){const e=t({perecnt:0,circlePercent:0});return{state:e,add:(t="")=>{h((()=>{"circle"===t?(e.circlePercent=e.circlePercent+20,e.circlePercent=e.circlePercent>100?100:e.circlePercent):(e.perecnt=e.perecnt+20,e.perecnt=e.perecnt>100?100:e.perecnt),console.log(e.circlePercent)}))},decrease:(t="")=>{h((()=>{"circle"===t?(e.circlePercent=e.circlePercent-20,e.circlePercent=e.circlePercent<0?0:e.circlePercent):(e.perecnt=e.perecnt-20,e.perecnt=e.perecnt<0?0:e.perecnt)}))}}}},[["render",function(e,t,l,r,a,i){const o=C(s("kui-progress"),W),c=C(s("kui-cell-group"),v),f=g,k=C(s("kui-icons"),I),m=C(s("kui-button"),T),x=C(s("kui-space"),P),h=C(s("kui-page"),S);return n(),u(h,{"custom-header":!1},{body:d((()=>[p(x,{gap:[50,0],direction:"column"},{default:d((()=>[p(c,{title:"基本用法"},{default:d((()=>[p(o,{percent:30,color:"primary"})])),_:1}),p(c,{title:"设置宽度和颜色"},{default:d((()=>[p(o,{percent:30,"line-width":30,color:"warning","label-text-color":"orange"})])),_:1}),p(c,{title:"不显示百分比"},{default:d((()=>[p(o,{percent:30,color:"primary",label:!1})])),_:1}),p(c,{title:"标签内显"},{default:d((()=>[p(f,{class:"kui-mb-3"},{default:d((()=>[p(o,{percent:30,"line-width":10,color:"primary","label-inside":"","label-inside-text-bottom":"1px"})])),_:1}),p(f,{class:"kui-mt-5"},{default:d((()=>[p(o,{percent:50,"line-width":20,color:"primary","label-inside-text-bottom":"1px","label-inside":""})])),_:1}),p(f,{class:"kui-mt-5"},{default:d((()=>[p(o,{percent:70,"line-width":30,color:"primary","label-inside":"","label-inside-text-bottom":"2px"})])),_:1})])),_:1}),p(c,{title:"自定义内容內显"},{default:d((()=>[p(o,{percent:50,"label-inside":"","inside-label-style":{bottom:"0px"}},{default:d((()=>[p(k,{type:"heart",theme:"danger",size:50})])),_:1})])),_:1}),p(c,{title:"开启进度条动画"},{default:d((()=>[p(o,{percent:30,color:"primary",active:""})])),_:1}),p(c,{title:"自定义图标"},{default:d((()=>[p(o,{percent:30,color:"primary","icon-name":"check_circle","label-text-color":"primary","label-text-size":36})])),_:1}),p(c,{title:"方形进度条"},{default:d((()=>[p(o,{percent:30,shape:"square",color:"primary"})])),_:1}),p(c,{title:"动态改变"},{default:d((()=>[p(o,{percent:r.state.perecnt,color:"#00BC79"},null,8,["percent"]),p(f,{class:"kui-flex kui-justify-center kui-mt-3"},{default:d((()=>[p(m,{onClick:r.decrease},{default:d((()=>[b("减少")])),_:1},8,["onClick"]),p(f,{class:"kui-mx-1"}),p(m,{type:"primary",onClick:r.add},{default:d((()=>[b("增加")])),_:1},8,["onClick"])])),_:1})])),_:1}),y("",!0)])),_:1})])),_:1})}]]);export{w as default};
