import{r as e,u as a,h as r,j as o,k as s,f as t,o as i,c as l,w as d,a as n,l as c,m as u,q as m,s as p,t as g,v as f,i as h}from"./index.6e0bac9a.js";import{_ as y}from"./kui-icons.87a80e4b.js";import{r as k}from"./kui-page.9f67228f.js";import{g as w}from"./element.f2d79fb5.js";import{_ as S}from"./plugin-vue_export-helper.21dcd24c.js";var x={src:{type:String,default:""},width:{type:String,default:"100%"},height:{type:String,default:""},mode:{type:String,default:""},fadeShow:{type:Boolean,default:!0},delay:{type:Number,default:1e3},radius:{type:Number,default:0},scale:{type:Number,default:1},error:{type:Boolean,default:!1},loading:{type:Boolean,default:!0},preview:{type:Boolean,default:!1},lazyload:{type:Boolean,default:!1}};const v=e=>e.endsWith("px")?"px":e.endsWith("rpx")?"rpx":e.endsWith("rem")?"rem":"",b=e=>e.split(v(e))[0];var z;var E=S({name:"kui-image",props:x,emits:["click","previewImageSuccess","previewImageFail"],setup(t,i){const l=e({animateShow:t.fadeShow,loadError:!1,loading:t.loading,iconSize:100,slotLoading:a().loading,slotError:a().error,src:t.src,lazyloaded:!1}),d=w();t.delay&&setTimeout((()=>{l.loadError=!1,l.animateShow=!1}),t.delay);let n=0;return g({src:t.src,success:e=>{n=e.height,l.loading=!1}}),setTimeout((()=>{(()=>{t.src;const e=t.height;if(e)if("px"===v(e))l.iconSize=b(e);else{const a=b(e);l.iconSize=a/2}else l.iconSize=n})()}),800),r((()=>{setTimeout((()=>{t.lazyload&&(z=o(this)).relativeToViewport({bottom:0}).observe(`.${d}`,(e=>{e.intersectionRatio>0?l.loading=!1:e.intersectionRatio<=0&&(l.loading=!0)}))}),1e3)})),s((()=>{z.disconnect()})),{props:t,data:l,elId:d,onLoadSuccess:e=>{setTimeout((()=>{l.loadError=!1,l.loading=!!t.lazyload,l.animateShow=!1}),t.delay)},onLoadError:e=>{l.loadError=!0},onClick:e=>{t.preview?p({urls:[t.src],current:0,success:e=>{i.emit("previewImageSuccess",e)},fail:e=>{i.emit("previewImageFail",e)}}):i.emit("click")}}}},[["render",function(e,a,r,o,s,p){const g=f,w=k(t("kui-icons"),y),S=h;return i(),l(S,{class:c(["kui-leading-none",o.elId])},{default:d((()=>[n(g,{src:e.src,style:{width:"0px",height:"0px"},onLoad:o.onLoadSuccess,onError:o.onLoadError},null,8,["src","onLoad","onError"]),o.data.loading||e.error?(i(),l(S,{key:0,class:c(["kui-bg-gray-200 kui-flex kui-flex-col kui-justify-center kui-items-center",o.data.animateShow?"kui-animate-pulse":""]),style:u({width:e.width,height:e.height,borderRadius:`${e.radius}rpx`})},{default:d((()=>[n(w,{type:"image",size:Number(o.data.iconSize),class:"kui-text-gray-300"},null,8,["size"])])),_:1},8,["class","style"])):m("",!0),o.data.loading||!o.data.src||e.mode||e.error?m("",!0):(i(),l(g,{key:1,src:o.data.src,style:u({width:e.width,height:e.height,borderRadius:`${e.radius}rpx`,transform:`scale(${e.scale})`}),onClick:o.onClick},null,8,["src","style","onClick"])),!o.data.loading&&o.data.src&&e.mode?(i(),l(g,{key:2,src:o.data.src,mode:e.mode,style:u({borderRadius:`${e.radius}rpx`,transform:`scale(${e.scale})`}),onClick:o.onClick},null,8,["src","mode","style","onClick"])):m("",!0)])),_:1},8,["class"])}],["__scopeId","data-v-59da2a13"]]);export{E as _};
